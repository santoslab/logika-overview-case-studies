package org.sireum

import U64._
import org.sireum.test.TestSuite

class T1haTest extends TestSuite {

  val tests = Tests {

    * - test(data => Hash.t1ha0(data, u64"0"), expected0)

    * - test(data => Hash.t1ha(T, data, u64"0"), expected1)

    * - test(data => Hash.t1ha(F, data, u64"0"), expected2)
  }

  def expected0: ISZ[U64] = ISZ(
    u64"0x0000000000000000",
    u64"0x234B245CF8ED5D4F",
    u64"0x98D1AF8BDB443133",
    u64"0x94D145656BD9C9CC",
    u64"0x5311E80FE162019A",
    u64"0x44D685042DAACF51",
    u64"0x28A1D073C4F10C45",
    u64"0x9514A77953788DB1",
    u64"0xA39A4FDB33306F6B",
    u64"0x7C0272045CE34478",
    u64"0xE8F7998C1E337E3C",
    u64"0xC06CF36EC4B9EA6D",
    u64"0x7F96C932AB117159",
    u64"0x6176ABA65160A3B3",
    u64"0x9FC6B593D8E7034A",
    u64"0xA289690E3AC6AB07",
    u64"0x866AFAFAD9BA9F4C",
    u64"0x40C1A47D21E06951",
    u64"0x6FCF257BAB0A78C2",
    u64"0xACC7DFCC2AFA67B4",
    u64"0xBC2992D00194E70D",
    u64"0xCF7216DED664042E",
    u64"0x23A7CBDC94EEFEE0",
    u64"0x5ED4B70BBE900740",
    u64"0x337CA0EF0BCEF0FF",
    u64"0x7EF7533E63D105DC",
    u64"0x2D20CF4F66C2526A",
    u64"0x663B597C2FD2D674",
    u64"0x7AE1817D877A0291",
    u64"0x95B1918499DCF03C",
    u64"0xB40EFBF7570840A3",
    u64"0x8B19CE3DFCECBBBE",
    u64"0x45E753C29793A367",
    u64"0x58E8362AEE9389BE",
    u64"0x7E3AEE0A31C5BD38",
    u64"0xE3D27C0EB5B89121",
    u64"0x71649A0300ABBDC1",
    u64"0xB0105E315541A576",
    u64"0x041D8EBCBADF5271",
    u64"0x99B8028166D1FDA3",
    u64"0x5EE0D907366B0A90",
    u64"0x3641A10B14C12243",
    u64"0xE1A8E3B70D0EF20A",
    u64"0x9FBC870285C0B74D",
    u64"0xE19F90B41F9FE951",
    u64"0xDE86AD0EB4F0A4AF",
    u64"0x8BF8BE148836CD8E",
    u64"0xEFF58834260120C9",
    u64"0x594B77E3AD44229B",
    u64"0x514232F5459A6E2B",
    u64"0x0920F4668DF0730A",
    u64"0x782DC64A5BF48D41",
    u64"0xEC2DF42AEA4BF31B",
    u64"0xD2F8F7B529B4A40D",
    u64"0xE28DF1ABD37A1446",
    u64"0x8ED52F37E8DBF066",
    u64"0x3805B1E14E0103FE",
    u64"0x02CD8A565D0758BA",
    u64"0x63EBD012DD736430",
    u64"0x8FE711053F607A1F",
    u64"0x9700B82F4E26DB09",
    u64"0x81FEBF771D3DAB15",
    u64"0x442F47E57964D2AE",
    u64"0xF0E882F0271DACBA",
    u64"0x8128701D3DA62E38",
    u64"0x952DF4B7CC0D6B51",
    u64"0x788068642F33ABA9",
    u64"0x848BB752C1B544E2",
    u64"0x9CA158343116A2C2",
    u64"0xC341EC8055A536B8",
    u64"0xE3B930D7E23211D4",
    u64"0x5FB5C3A4524A0FA6",
    u64"0x1810F71999A08CB6",
    u64"0x55E13EEA4B8F313C",
    u64"0x12F74120009C0AD1",
    u64"0x467FA49E4E36A8D4",
    u64"0xB10563C83351C67B",
    u64"0xB167D725C9CA5CB4",
    u64"0x99A528C8B8CCCF04",
    u64"0xDB58548ED28999A9",
    u64"0x0D2F716F1E45B676",
    u64"0x14D233B7CFA7DA45",
    u64"0x43056CF31F7B6F35",
    u64"0x9D381EE8DCE51326",
    u64"0x99BEF8C1F0F60A16",
    u64"0xB17085BEE082631A",
    u64"0x4F1B2D39A1345FB9",
    u64"0xC4721025758D276E",
    u64"0xF358BDAF2B73B9B3",
    u64"0xE6C9AAD74275757F",
    u64"0x2942062965A6C984",
    u64"0xDA672ADE373626D0",
    u64"0x1E4C34DC719CD1A5",
    u64"0x54070052435390DE",
    u64"0x81A1D601B61AFC00",
    u64"0x2DC027A72461B200",
    u64"0x3264347A873C2F9D",
    u64"0xE85EEDF58FD49899",
    u64"0x233E24D4E7A22C9F",
    u64"0xCDFD9F1192C22F74",
    u64"0xA2B4A8B20B672CC2",
    u64"0x043743A367ACDCE1",
    u64"0xE028D4F0B11DEE9B",
    u64"0xB5BB4EB9EF91F1C6",
    u64"0x4C710F2386BE70FE",
    u64"0xA9F16D58F63A7D71",
    u64"0x4A280B775080F89A",
    u64"0x80E6EDC901DE5988",
    u64"0x74DE85B51DAAAC1C",
    u64"0x6E79A705F0080299",
    u64"0x23D7BF821F219D61",
    u64"0x549DC19DD0E0630D",
    u64"0xB85542DD804BC2A7",
    u64"0x92F12E65A154A518",
    u64"0x0044AC9FACA3BFF2",
    u64"0x0BC5EB0D2E6C0EFE",
    u64"0x1B4451D80CC1A5A1",
    u64"0x7F626DAB5DD0E648",
    u64"0x0390F6B27116421B",
    u64"0x4B3E852874320931",
    u64"0x753A278F9395E7F7",
    u64"0xC030999D6BF54B95",
    u64"0x6E70C22FFACEB9C8",
    u64"0x45AA3B500B0DFEA2",
    u64"0x19112379F528F9C5",
    u64"0x6E98FB7EACBFDC1D",
    u64"0x5FAD5280868E6C04",
    u64"0xBE66CDA7E87C25C3"
  )

  def expected1: ISZ[U64] = ISZ(
    u64"0x0000000000000000",
    u64"0x5C2DD46C53FEEE85",
    u64"0xAAA97C91C9FA3626",
    u64"0xF8EBEB2873BB8D88",
    u64"0x2A75C74683940354",
    u64"0xB410FF5B5DDEAF1B",
    u64"0x093DE5D546344471",
    u64"0xE91DF5DC0F85D38A",
    u64"0xDBD474DC31429C81",
    u64"0x4F30B22073203D4F",
    u64"0x39FCCB7DCCD0087D",
    u64"0xBEFA8DD6969C6532",
    u64"0xD38787DD5654BD7E",
    u64"0xC3F1C2BD078A0E03",
    u64"0x07B391D2FF90D571",
    u64"0x52A71F3966006007",
    u64"0x32FB0424390F6309",
    u64"0x65419DC237F7431B",
    u64"0x1A36850A28D2F71C",
    u64"0x8DD38E258EF341BB",
    u64"0xC2A2444290D6CED6",
    u64"0x30D82E0EDD27074E",
    u64"0xCF3B117F4379B20B",
    u64"0xC560B9D345B1958E",
    u64"0x3FE24F2FA632797B",
    u64"0xEDC49E43D86B9DA2",
    u64"0x3C29C74F5D11C62B",
    u64"0x9EEB7174971782E0",
    u64"0x4752A3502B5C1A0A",
    u64"0x52BB874A42C12261",
    u64"0x2434310D717FE4EE",
    u64"0xC78578D0009CC72C",
    u64"0x3F2977798F83D313",
    u64"0x8E5D555FD3C19186",
    u64"0x8568252D9D4270ED",
    u64"0x3C56B0AACB77ED09",
    u64"0xCDAA24E12FD2FECA",
    u64"0x997EA8D5B350417B",
    u64"0x500EFCA50CC396A7",
    u64"0x0BF853DA78A9BA4C",
    u64"0x727C3B7E80A28232",
    u64"0x84171F53E9004AE0",
    u64"0xEC440E587D6062A6",
    u64"0x57D20C6A2D04E017",
    u64"0xA25DB96A67180357",
    u64"0x3161CA9B7AE24D89",
    u64"0xD18E0CB821038081",
    u64"0x16E8055D0DD0F1EE",
    u64"0xA943F848A096D920",
    u64"0x8EAC83DBA2788904",
    u64"0xB5B76CA065C461B9",
    u64"0x9E9E34B89AC5F12B",
    u64"0xDBA247F3659720AA",
    u64"0x6AF6273A78104E3E",
    u64"0x32179674CD122F04",
    u64"0xC63B34DE56CC001A",
    u64"0x732C798419EDF4ED",
    u64"0xE2E1592CB6CE0F31",
    u64"0x66FD55EF774C41C2",
    u64"0x58D69A9A42A36956",
    u64"0xC09DC05FE5A93BE0",
    u64"0xB7D55806959758AD",
    u64"0x147606D33497997F",
    u64"0xAC79E0FAC9221AD2",
    u64"0xD357A57DDBAA6822",
    u64"0x9057CC5845B1BD2E",
    u64"0x380CD413A7C1111F",
    u64"0x810618E1B5BB6FFB",
    u64"0xC6FE70FC607A7864",
    u64"0x847E065915BE7514",
    u64"0xF6018F7F2EFD0061",
    u64"0x193079F79F28D41A",
    u64"0x5408B41A95D56D24",
    u64"0x5CED0C9EA580180F",
    u64"0xB01AAC44300ABFA5",
    u64"0x789ADCADCFAC4BDE",
    u64"0x3A088AB3A99FAE05",
    u64"0x7DF903D695FA364E",
    u64"0x3196001C87E03E60",
    u64"0x6E8F60F4EBB819D4",
    u64"0x7FFE9D8C7491B1F5",
    u64"0x8174978A2F6D3E8C",
    u64"0x25BC4D29EEDCB6A0",
    u64"0xF68E153E49747F52",
    u64"0x2A450E5FB8049247",
    u64"0x6000D02E58601FD4",
    u64"0xFE5BB8C86464A809",
    u64"0xA7AD430D2C4AF684",
    u64"0x836F3F1CD2BC683F",
    u64"0x5CBCE89E7434AD7C",
    u64"0x1C2E6384704377F9",
    u64"0x7A97D0AAA14FD431",
    u64"0x473A7B89DBE146B2",
    u64"0x7417400269FB89ED",
    u64"0xA572788A624DE11C",
    u64"0x49EC8F85EDD4B910",
    u64"0xE66DF9C40DB92544",
    u64"0x4B05857C153D2F84",
    u64"0x5456DA8F4E1CE644",
    u64"0x86382FEB23A94F59",
    u64"0xED6602CFEBB9BFB5",
    u64"0xF9119E9EACC68DCE",
    u64"0x44AC0C798BD0C51C",
    u64"0x992ECDD1A66299FD",
    u64"0x854B1C6A05D93941",
    u64"0x66EE94140D6720F1",
    u64"0x495058C0889131A0",
    u64"0x1DE367E14AF21ECE",
    u64"0xFC60B45561798F9F",
    u64"0xBC7517A770DE07BD",
    u64"0xDD423D8F408F4515",
    u64"0x225FDDAAFB5E608C",
    u64"0x7292706B2E99F47A",
    u64"0x2CC73834E7EFB4D7",
    u64"0x3EB64B60448E39ED",
    u64"0xBC16F6E1FDB20513",
    u64"0x3BC35AE519645135",
    u64"0xC73C5113A21EFD38",
    u64"0xD1417B4A1ED21499",
    u64"0x54B898DA34E73580",
    u64"0xCDD35A7E74972640",
    u64"0x0F22DB2F4BACEE52",
    u64"0x628114CD4E34F3B3",
    u64"0xF8131A1936BF6DF5",
    u64"0xAFFD15494EB9ABFE",
    u64"0x851B3C84064A4E2A",
    u64"0x2BAC2ABCEBE39407",
    u64"0x0D3A39C2414F19BD"
  )

  def expected2: ISZ[U64] = ISZ(
    u64"0x0000000000000000",
    u64"0x5D7010803EACA6D3",
    u64"0xFDF59A7C7D8A519C",
    u64"0xDD9EB2FA48095A19",
    u64"0x0BAD65D73601DD1A",
    u64"0x601282E29681DDE9",
    u64"0x56A93BFAC41BF1D1",
    u64"0xF9DD5886D6652EDA",
    u64"0xEF651C74EB6396F8",
    u64"0xFA1A99EE9F2C4221",
    u64"0x4EB9337DE1C187F1",
    u64"0xC5D7057C99D037D3",
    u64"0x9C81F4125C981AD6",
    u64"0x758A2CEB2D1C51B9",
    u64"0x6E114131E8D73E90",
    u64"0x53A76869317ECD30",
    u64"0x5E7543C6CDF8A46E",
    u64"0x8147EF75FABD9557",
    u64"0xE522A4BB7CB1B40A",
    u64"0x48169639283690C2",
    u64"0x433AEF2C370EDBFC",
    u64"0xE615598545928D43",
    u64"0x00DF356B68AE9F9B",
    u64"0x4B5923C3F2B97169",
    u64"0x7967BA2114612421",
    u64"0xE62F3672269C89D3",
    u64"0x3369C77F032FEE9A",
    u64"0xBAD50FA4B00562E4",
    u64"0xE2888F882A082C57",
    u64"0x661FF41FF4D60828",
    u64"0x3FCB34655ECE5D7E",
    u64"0x2FA90FF052CDB85E",
    u64"0x0C70515570773008",
    u64"0xB260289A424BB4C6",
    u64"0xA6C99A2C4D43BDC2",
    u64"0x35B4E80A4B661063",
    u64"0x955D8C7743761526",
    u64"0xF52FC7EEC2A1FEE9",
    u64"0xF224FF875C4F5ED6",
    u64"0x98EA2B69E3E149B5",
    u64"0x7307E1419C4A8B10",
    u64"0x6FC18C4E0643EACF",
    u64"0xDE746B16A0C60D49",
    u64"0x813F28E0505AAAA3",
    u64"0x92B5FC605F9DE10D",
    u64"0x5EB7F1AB0C3AA0F2",
    u64"0xF47C678B9DC3D525",
    u64"0x48D8DF0E38ABED2E",
    u64"0xF119FF1F395F9DCC",
    u64"0x0E4BE2D90ACF4B1F",
    u64"0xD7C4D4C5401AD2C2",
    u64"0xE7CF679611453368",
    u64"0x4CC88F1E82D03FF7",
    u64"0xEBCC884B48BA52E0",
    u64"0x259AE49941E372DD",
    u64"0xDD09741C934DC12F",
    u64"0xA50849342BA46C79",
    u64"0x653BE5C767E0B516",
    u64"0x5680AC1EC335BFFB",
    u64"0x32F596FCDA9BE954",
    u64"0x34A577CA96456E8E",
    u64"0x21A31A197F0AAD47",
    u64"0x90E0DCC6EA4B13D4",
    u64"0x5544B58D0AB1C1D6",
    u64"0xAAE598ED4F666040",
    u64"0x5FDE28576B9D1D4E",
    u64"0xC526B9EEC11C5F0E",
    u64"0x8D7B3CBA248BA5C3",
    u64"0x9A5894541AE1FB8B",
    u64"0xF0D8A30FBEAD6F76",
    u64"0xFC31B67755FF3B68",
    u64"0xA0F2776140887728",
    u64"0x0C14D6F7D3B0A5A6",
    u64"0xF51AF7C3B3C3D0B7",
    u64"0xA2B97DA02A1142FE",
    u64"0x65A54570497D5307",
    u64"0xADBAA6FAFCCAB432",
    u64"0xC1A79C90E9C3F38C",
    u64"0x17E07F2AB1254EC1",
    u64"0x523BB6166EA7D844",
    u64"0xA3D30A1768519A5A",
    u64"0x4D15549C3CDEA642",
    u64"0xE105B22AE0AD756C",
    u64"0x6E96562C594122D3",
    u64"0xC205298E7DA6BF01",
    u64"0x57B36737A35739D8",
    u64"0x62BBD3BB1E9DED92",
    u64"0x56A486DA2898F658",
    u64"0x03F8F4E72E168BB3",
    u64"0x17E9C37A061E927C",
    u64"0x76F7F092498CEE51",
    u64"0x712041F97557250F",
    u64"0xB0B0549FB9FBAE50",
    u64"0x66AF4CF08DADF735",
    u64"0x559F19CB771F9D43",
    u64"0x20488B8AF01CA1D0",
    u64"0xA340D47FDBDA75BA",
    u64"0xD7E87B85686E799D",
    u64"0xA94D030CDAD6A522",
    u64"0xB47052ACA69BF22D",
    u64"0xFCD244A7602A483E",
    u64"0x76DC6129C5D99B88",
    u64"0x3477953EC4FC3C2B",
    u64"0xCB8C6D2AF2D791CB",
    u64"0xA19CA15606A57E82",
    u64"0x924F720A73533C6B",
    u64"0xD097EA42838DD5CA",
    u64"0x1742B120AD9DF2C5",
    u64"0xF737812B2C80C8F8",
    u64"0xA2F1F65989DDFCF7",
    u64"0xF56085AD83D290A5",
    u64"0x0CBC37D69FBCBA78",
    u64"0x2DE8902285AB7FAA",
    u64"0x7F6CE3FCE9391063",
    u64"0x0BAD1AE8563A4641",
    u64"0xD8A39228EBD5EF02",
    u64"0x263DB7824BC5F97D",
    u64"0x330AB6954C39F7B9",
    u64"0x6C41AADA1650E255",
    u64"0xB38C062D4BA2B582",
    u64"0x97AB993724D326BD",
    u64"0x9E752944352D20F7",
    u64"0x9AA7BE8567C070E3",
    u64"0xB2C00FC38B1EEEC6",
    u64"0x208224A861DDADD3",
    u64"0xC24AA09A31BCE5C2",
    u64"0x248698CA1A54D44D",
    u64"0xF1D7480636580893"
  )

  def test(f: ISZ[U8] => U64, expected: ISZ[U64]): Unit = {
    var data = ISZ[U8]()
    for (i <- expected.indices) {
        val result = f(data)
        assert(result == expected(i))
      data = data :+ conversions.Z.toU8(i)
    }
  }
}
